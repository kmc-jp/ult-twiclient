<!DOCTYPE html>
<head>
  <meta charset="UTF-8">
  <script src="//cdnjs.cloudflare.com/ajax/libs/twemoji/1.3.2/twemoji.min.js"></script>
  <script src="./index.js"></script>
  <link rel="stylesheet" href="../style/main.css">
</head>

<body>
  <template id="small-tweet" style="display: none;">
    <div>
      <button v-on:click="vm.clearReply()" v-if="replysender">X</button>
      <img class="small_user_icon"
           v-bind:src="tweet.user.profile_image_url_https">
        {{ tweet.text }}
    </div>
  </template>
  <div id="container" v-on:keypress="detectKeyDown($event)" tabindex="-1">

    <div id="topbar">
      this is the ultimate twitter client !!!!
      <a href="./preference.html">pref.</a>
      <input type="text" v-model="newTweet.text" v-el:submit_box>
      <button v-on:click="sendTweet(newTweet)" v-bind:disabled="isExceededTweet">
        „ÉÑ„Ç§„Éº„Éà
      </button>
      <span v-bind:class="{ 'long_tweet': isLongTweet, 'exceeded_tweet': isExceededTweet }">
        {{ calculateRemainChar }}
      </span>
      <button v-on:click="startStreaming()" v-bind:disabled="streaming">
        „Çπ„Éà„É™„Éº„Éü„É≥„Ç∞
      </button>
      <small-tweet v-if="newTweet.in_reply_to_status_id"
                  :tweet="sendReplyDestTweet" :replysender="true">
      </small-tweet>
    </div>

    <div id="image_view" v-if="showingImage" v-on:click="closeImage()">
      <img v-bind:src="image.url" v-bind:width="image.width"
           v-bind:height="image.height" v-on:contextmenu="contextMenuOnImage()">
    </div>

    <div id="outline">
      <ul id="tweets">
        <li v-for="tweet in tweets | orderBy 'id' -1"
            v-bind:class="{
              'retweeted_status': tweet.retweeted_status,
              'mentions_for_you': isMentionsForYou(tweet)
            }"
            v-on:contextmenu="contextMenuOnTweet(tweet)">
          <div class="user_icon">
            <img v-bind:src="body(tweet).user.profile_image_url"
                 v-on:click="sendReply(body(tweet))">
          </div>

          <div class="tweet_info">
            <div>{{ body(tweet).user.name }} @{{ body(tweet).user.screen_name }}</div>
            <span>
              {{{ body(tweet).text | expand_url body(tweet).entities | twemoji }}}
            </span>
            <div v-if="hasMedias(tweet)">
              <img v-for="media in tweet.extended_entities.media"
                   v-if="media.type == 'photo'"
                   v-bind:src="media.media_url" v-bind:width="media"
                   v-on:click="showImage(media.media_url, media.sizes.small)"
                   class="photo_thumbnail">
            </div>
            <small-tweet v-if="body(tweet).quoted_status"
                        :tweet="body(tweet).quoted_status" :replysender="false">
            </small-tweet>
            <small-tweet v-if="body(tweet).in_reply_to_status"
                        :tweet="body(tweet).in_reply_to_status" :replysender="false">
            </small-tweet>
            <div>
              <span v-on:click="favoriteTweet(body(tweet))">
                <span v-if="body(tweet).favorited">üç£</span>
                <span v-else>üçö</span>
                {{ body(tweet).favorite_count }}
              </span>
            </div>
            <div class="created_at">
              <span class="url" v-on:click="jumpToTwitterURL(tweet)">
                {{ convertTime(body(tweet).created_at) }}
              </span>
            </div>
            <div class="retweeted_by" v-if="tweet.retweeted_status">
              retweeted by @{{ tweet.user.screen_name }}
            </div>
          </div>

        </li>
      </ul>
    </div>

    <div id="notifier">
      <div class="notification" v-for="notification in notifications"
           v-bind:class="notification.kind" v-on:click="removeNotification(notification)">
        {{ notification.title }} : {{ notification.body }}
      </div>
    </div>

  </div>
</body>
